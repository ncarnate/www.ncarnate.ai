const TAG="pop-up",SHOW_DELAY=500,HIDE_DELAY=300,raf=requestAnimationFrame,delay=function(ms,fn){return setTimeout(fn,ms)},undelay=clearTimeout;class Element extends HTMLElement{constructor(){super(),_init(this)}is_shown(){return this.classList.contains("show")}toggle(){_toggle(this,!this.is_shown())}show(tmpl_id){this.is_shown()||_toggle(this,!0,tmpl_id)}hide(){this.is_shown()&&_toggle(this,!1,this._tmpl_id)}}customElements.define(TAG,Element);function _init(el){el.innerHTML=`        
        <div class="bg"></div>
        <div class="fg"></div>        
    `,el._tmpl_id="",el._tmpl_frag=void 0,el._delay=0,el.onclick=function(e){el===e.target&&el.hide(),e.target.classList.contains("button_close")&&el.hide()},el.is_shown()&&_toggle(el,!0)}function _append_tmpl(el,tmpl_id){let fragment;el._tmpl_id==tmpl_id&&el._tmpl_frag!=void 0?fragment=el._tmpl_frag:(el._tmpl_id=tmpl_id,fragment=el._tmpl_frag=document.getElementById(tmpl_id).content.firstElementChild.cloneNode(!0)),el.querySelector(".fg").appendChild(fragment)}function _remove_tmpl(el){el.querySelector(".fg").removeChild(el._tmpl_frag)}function _toggle(el,show,tmpl_id){if(el._delay)return;raf(show?function(){_append_tmpl(el,tmpl_id),el.classList.remove("hidden"),raf(function(){el.classList.add("show"),document.documentElement.classList.add("popup-shown")})}:function(){el.classList.remove("show"),el._delay=delay(HIDE_DELAY,function(){raf(function(){_remove_tmpl(el),el.classList.add("hidden"),document.documentElement.classList.remove("popup-shown")}),el._delay=0})})}